{% extends "base.html" %}
{% load extra_tags %}

{% load markup questionnaire i18n %}


{% block headextra %}
<script type="text/javascript" src="{{ STATIC_URL }}jquery.min.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}questionset.js"></script>
<link rel="stylesheet" href="{{ STATIC_URL }}css/vendor/chosen.css"></script>
<link rel="stylesheet" href="{{ STATIC_URL }}progressbar.css"></script>
{% for x in jsinclude %}
<script type="text/javascript" src="{{ x }}"></script>
{% endfor %}
    
    {% for x in cssinclude %}
<link rel="stylesheet" href="{{ x }}" type="text/css" />
{% endfor %}



{% if async_progress %}
<script type="text/javascript">var progress_url = "{{ async_url }}";</script>
<script type="text/javascript" src="{{ STATIC_URL }}progress.js"></script>
{% endif %}
{% endblock %}

{% block language %}
    {% for lang in LANGUAGES %}{% if not forloop.first %} |{% endif %}
<a href="{{request.path}}?lang={{ lang.0 }}">{{ lang.1 }}</a>
{% endfor %}
{% endblock %}

{% block content %}

<div class="container">
  <div class="jumbotron">

   <div class="span12" style="text-align:center">
    <h2>Advanced Search</h2>

    <div style="display:none">
  <em>Filter: </em>
          <select data-placeholder="Your Favorite Football Team" style="width:600px;" class="chosen-select" multiple tabindex="6">
            <option value=""></option>
            <optgroup label="NFC EAST">
              <option>MCI - definition: Neuropsychological Test, Functional impairment (eg CDR)</option>
              <option>Medication use: Collected</option>
              <option>Urine: Routine</option>  

            </optgroup>
            
          </select>
        
    </div>


  </div>

  </div>
</div>
<hr>
<div class="row">
<div class="span3">
  <div class="well" style="max-width: 340px; padding: 8px 0;">

    <ul class="nav nav-list nav-pills nav-stacked ">
      <li class="nav-header">Step-by-Step</li>
      {% for qs in questionset.questionnaire.questionsets %}

      {% if qs.sortid != 0 and qs.sortid != 99 %}
      <li{% if questionset.text == qs.text %} class="active" {% endif %} id="li_qs_{{qs.id}}">
        <!--<a href="q2/{{runinfo.random}}/{{ qs.sortid }}">
        -->
        <a href="advancedSearch/{{qs.questionnaire.pk}}/{{ qs.pk }}" onclick="questionsets_handle(qs_{{ qs.pk }}); return false;">
          <table>
            <tr>
              <td width="80%">{{ qs.text|removeh1 }}</td>
              <td width="10%">
                <!--<span style="float:right; vertical-align: middle " class="badge badge-warning">2</span>
              -->
            </td>
          </tr>
        </table>
      </a>
      {% endif %}
    </li>
    {% endfor %}
  </ul>

</div>
</div>

<div style="overflow-y:scroll;height:800px;">
{% include "fingerprint_search.html" %}
</div>

</div>
<script type="text/javascript" src="{{ STATIC_URL }}js/vendor/chosen.jquery.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/emif.advanced_search.js"></script>
<script type="text/javascript">
        {% for trigger in triggers %}
            addtrigger("{{trigger}}");
        {% endfor %}
        
        {% for k,v in qvalues.items %}
            qvalues['{{ k|escapejs }}'] = '{{ v|escapejs }}';
        {% endfor %}
        
        for(key in qvalues) {
            valchanged(key, qvalues[key]);
        }
    </script>
{% endblock %}

{% block scriptextra %}
$('#li_advanced_search').addClass("active");

function next_questionset(id_questionset)
{

  var next = false;
  $('.questionset').each(function(i, obj) {
    console.log("obj.id: " + obj.id);
    console.log("next" + next);
    if (next==true)
    {
      questionsets_handle(obj);
      next = false;

  }
    if (obj.id==id_questionset.id)
    {
      next = true; 
    }
    
 
      
  }

  );

}



function questionsets_handle(id_questionset)
{

  console.log("Clicked QuestionSet: " + id_questionset.id);
  $('.questionset').each(function(i, obj) {
    console.log("obj.id: " + obj.id);
    if (obj.id==id_questionset.id)
    {
        console.log("show " + obj.id);
       $('#'+obj.id).addClass("show");
       $('#li_'+id_questionset.id).addClass("active");

    }
  
    else {
      console.log("hide " + obj.id);
      $('#li_'+obj.id).removeClass("active");
      $('#'+obj.id).addClass("hide");
      $('#'+obj.id).removeClass("show");
    }
 
      
  }

  );

};



{% endblock %}