
{% load extra_tags %}
{% load markup questionnaire i18n %}
<div class="span8">
    <form name="qform" id="qform" action="addPost/{{questionset.questionnaire.pk}}/1" method="POST">
    {% for k, qlist in questions_list %}

    <div id="qs_{{ k.pk }}" class="{% if k.pk == questionset.pk %} {% else %} hide {% endif %} questionset">
    {% if k.pk == questionset.pk %}     
        <input type="hidden" name="active_qs" value="{{ k.pk }}">
        <input type="hidden" name="active_qs_sortid" value="{{ k.sortid }}">
    {% endif %}
    <div class="questionset-title" style="font-size:6px">
    <h3>{{ k.text|removeh1 }}</h3>
    </div>

        {% csrf_token %}

        <input type="hidden" name="questionset_id" value="{{ questionset.id }}">
    
        {% for question, qdict in qlist %}

        {% with errors|dictget:question.number as error %}

            <div class="question type_{{ qdict.qtype }} {% if error %} error prepend-top{% endif %}{{ qdict.qnum_class }}{{ qdict.qalpha_class }}" id="qc_{{ question.number }}" {{qdict.checkstring|safe}}>                
                {% if request.user.is_staff %}
                    <span class="pull-right">
                        <a href="/admin/questionnaire/question/{{ question.id }}/">
                            ({% trans "edit" %} {{ question.number }})
                        </a>
                    </span>
                {% endif %}
                    
                {% if qdict.custom %}
                    {% if error %}
                        <div class="error">
                            {{ error }}
                        </div>
                    {% endif %}
                    {% include qdict.template %}
                {% else %}
                    <div class="question-text {% if qdict.required %}required{% endif %} {% if error %}text-error{% endif %}">
                        <span class="qnumber">{{ question.display_number }}.</span> 
                        {{ question.text|safe }}
                    </div>
                    <div class="answer">
                        {% if error %}
                            <div class="alert-message block-message text-error input">{{ error }}</div>
                        {% endif %}
                        {% include qdict.template %}
                    </div>
                {% endif %}


            </div> <!-- /question container -->
            {% if question.footer %}
                <div class="question-footer">
                    {{ question.footer|textile }}
                    <div class="clearfix"></div>
                </div>
            {% endif %}
        {% endwith %}

        {% endfor %}
    
            <div style="text-align: center;" class="well questionset-submit">
                <input class="btn large primary" name="submit" type="submit" value="{% trans "Continue" %}" 
                {% if k.sortid == 99 %} 
                onclick="javascript:window.location.href='databases';return false;"
                {% endif %}
                >
                  
            </div>
            
            {% if questionset.prev %}
                <a class="back-link pull-left" href="javascript:history.back();">{% trans "return to previous page" %}</a>
            {% endif %}

    
    </div>
    {% endfor %}
    </form>
</div>

