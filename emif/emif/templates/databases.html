{% extends 'base.html' %}
{% load url from future %}
{% load django_bootstrap_breadcrumbs %}

{% block breadcrumbs %}
    {{ block.super }}
    
    {% breadcrumb "My Databases" "databases" %}

{% endblock %}

{% block styleextra %}

button {
    border: 1px #AAA solid;
    padding: 4px 10px;
}
.hide {
    display: none;
}

{% endblock %}

{% block toolbar %}
{% include "menu_toolbar.html" %}

{% endblock %}

{% block headextra %}
<link rel="stylesheet" href="static/css/theme.blue.css">
{% endblock %}


{% block scriptextraincludes %}

<script src="static/js/vendor/jquery.tablesorter.min.js"></script>
{% endblock %}



{% block content %}

{% if list_databases %}
<table class="table table-hover tablesorter" id="table_databases" data-provides="rowlink">
    <thead>
        <tr>
            <th></th>
            <th>Name</th>
            <th>Date</th>
            <th>Modify</th>

        </tr>
    </thead>
    <tbody>
        
        {% for t in list_databases %}
        <tr>
            <td><img src="static/upload_images/{{t.logo}}" width="50px" height="50px"/></td>
          <td>
            <a href="fingerprint/{{ t.id }}/1">{{ t.name }}</a>
            
            <div style="margin-left:20px">
             Institution Name: {{t.institution}}
            </div>

            <div style="margin-left:20px">
             Location: {{t.location}}
            </div>
            <div style="margin-left:20px">
             Number of patients: {{t.number_patients}}
            </div>
        </td>
          <td>{{ t.date }} </td>
          <td>
<!--<div style="color:red">
<i class="icon-remove " ></i></div>-->
    
            <a  href="dbEdit/{{t.id}}/{{t.ttype}}"><img src="static/img/glyphicons_150_edit.png"/></a>
            <a class="confirm-delete" data-id="{{ t.id }}" ><img src="static/img/glyphicons_192_circle_remove.png"/></a></td>
          
        </tr>

        {% endfor %}

    </tbody>
</table>

{% else %}
<div class="row">  
<div class="span4">  
<div class="alert">  
  <a class="close" data-dismiss="error">Ã—</a>  
  <strong>Info: </strong> Currently, there are no databases in your account. You can add new ones through the option "Workspace -> Add new databases"
</div>  
</div>  
</div>  
{% endif %}

{% comment %}
  <a class="btn btn-large btn-success" href="advancedSearch/1">Add new database</a>
{% endcomment %}
</div>



<div id="modal-from-dom" class="modal hide fade" style="display:none"  >
    <div class="modal-header">
        <a href="#" class="close">&times;</a>
         <h3>Delete Fingerprint</h3>
    </div>
    <div class="modal-body">
        <p>You are removing the database fingerprint. This procedure is irreversible.</p>
        <p>Do you want to proceed?</p>
        <p id="debug-url"></p>
    </div>
    <div class="modal-footer">
        <a href="rm/ref" class="btn btn-danger">Yes</a>
        <!-- <a href="delete.php?some=param&ref=" class="btn danger">Yes 2</a> -->
        <a href="javascript:$('#modal-from-dom').modal('hide')" class="btn btn-secondary">No</a>
    </div>
</div>

{% endblock %}

{% block scriptextra %}
{% comment %}
<script>
{% endcomment %}


$(function() {

  // call the tablesorter plugin
  $("table").tablesorter({
    theme : 'blue',

    // sort on the first column and third column in ascending order
    sortList: [[0,0],[2,0]]
  });

});


$('#li_workspace').addClass("active");

$('#modal-from-dom').bind('show', function() {
    var id = $(this).data('id'),
        removeBtn = $(this).find('.btn-danger'),
        href = removeBtn.attr('href');
    console.log('id' + id);
    removeBtn.attr('href', href.replace('ref', '' + id));
});


$('.confirm-delete').click(function(e) {
    e.preventDefault();
    
    var id = $(this).data('id');
    $('#modal-from-dom').data('id', id).modal('show');
});

/*
jQuery('#add_toolbar').bind("click")
{
    $('#group_toolbar').addClass("open");    
}*/
jQuery('#add_toolbar').click(function () {
  //  console.log(jQuery(this).parent());
//jQuery(this).parent().addClass("open");

$('#group_toolbar').addClass("open");
console.log($('#group_toolbar'))
});


{% comment %}
</script>
{% endcomment %}

{% endblock %}